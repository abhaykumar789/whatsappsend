<div>
    <h2>View Excel Data</h2>
    <form (submit)="fetchData()">
        <input type="text" placeholder="Enter unique file name" [(ngModel)]="uniqueFileName" name="uniqueFileName" required />
        <button type="submit">Fetch Data</button>
    </form>

    <!-- Container for horizontal scrolling table -->
    <div style="overflow-x: auto; margin-top: 20px;">
        <table *ngIf="excelData.length > 0" border="1" style="min-width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background-color: #f2f2f2;">
                    <th>ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Address</th>
                    <th>Mobile 1</th>
                    <th>Mobile 2</th>
                    <th>Mobile 3</th>
                    <th>Mobile 4</th>
                    <th>Mobile 5</th>
                    <!-- Extra Keys Columns -->
                    <th *ngFor="let key of extraKeys.slice(0, 3)" style="display: table-cell;">{{ key }}</th> <!-- Extra columns visible when scrolled -->
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of excelData" style="text-align: center;">
                    <td>{{ data.id }}</td>
                    <td>{{ data.name }}</td>
                    <td>{{ data.email }}</td>
                    <td>{{ data.address }}</td>
                    <td>{{ data.mobile1 }}</td>
                    <td>{{ data.mobile2 }}</td>
                    <td>{{ data.mobile3 }}</td>
                    <td>{{ data.mobile4 }}</td>
                    <td>{{ data.mobile5 }}</td>
                    <!-- Extra Fields Data for Columns -->
                    <td *ngFor="let key of extraKeys.slice(0, 3)" style="display: table-cell;">{{ data.extraFields[key] }}</td> <!-- Extra fields visible when scrolled -->
                </tr>
            </tbody>
            <!-- Footer line for clarity -->
            <tfoot>
                <tr>
                    <td [attr.colspan]="9 + extraKeys.slice(0, 3).length" style="text-align: center; background-color: #e9ecef; font-weight: bold;">
                        End of Data
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>

    <!-- Display message if no data is found -->
    <p *ngIf="!excelData.length && fetched" style="margin-top: 20px; color: red;">No data found.</p>
</div>
